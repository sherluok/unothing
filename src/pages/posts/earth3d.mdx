# Earth Online
> 使用 WebGL 在浏览器中渲染地球

## 前言

本文的目标是从0开始在浏览器上渲染一个可交互的地球，整个过程不需要提前了解 WebGL API 的使用方法、线性代数、图形学和 GIS 相关的知识，因为这些都会在文中讲到。但是你需要提前掌握最基本的 Javascript 语法和浏览器运行环境的常识。
 
```
效果预览
```

你可以到 `https://github.com/sherluok/earth` 克隆本项目，跟随章节内容的进行对源代码进行修改。

- [第一章 WebGL API]()
- [第二章 着色器]()
  - [工作流程]()
  - [顶点着色器]()
  - [片元着色器]()
  - [正多面体细分]()
- [第三章 线性代数]()
  - [矩阵变换]()
    - [旋转]()
    - [缩放]()
    - [平移]()
  - [视图投影]()
    - [正交投影]()
    - [透视投影]()
  - [键鼠交互]()
- [第四章 GIS]()
  - [墨卡托投影]()


## 第一章 WebGL API

在浏览器中使用 WebGL 渲染图形大致分为以下几个步骤：
1. 创建或获取 Canvas 元素
2. 获取 WebGL 上下文（就在这一步处理不支持 WebGL 的浏览器）
3. 设置顶点着色器和片元着色器
4. 将顶点数据传递给顶点着色器
5. 顶点着色器按设置对传入的数据进行运算，得到每个顶点的颜色值
6. 片元着色器按设置对顶点着色器的运算结果进行运算或插值，得到每个像素的颜色值
7. 计算完所有像素后，组成图片显示到屏幕上

不要把你宝贵的时间花在记忆 WebGL 的每个 API 的使用方法，而是要完全理解它的工作流程，达到明白这些 API 为什么要设计成那种形态的程度。具体的使用方法，只需要在手边备上一本参考手册，或者到 MDN 上搜索相应的文档即可。

下面是一个 Demo，实现了以上7个步骤。这个 Demo 分为两部分，左边是代码的运行结果，右边是源代码编辑器。对，它是一个编辑器，你可以随意修改里面的代码并运行，还可以打开 Console 查看控制台输出。对了，它实际上是运行在一个 IFrame 里面的，所以如果你嫌弃它尺寸太小，可以在一个网页里独立打开。在你浏览文章的过程中，它的内容会跟随文章的内容进行变化，就像一个代码教学的专用 PPT，直到你看完了它涉及的内容，他就会自动消失。这是一个我专门为本文开发的一个叫做 [CodePlayer]() 的东西, 在后文中会经常出现。好了，废话不多说，让我们开始画一些简单的图形。

```
CodePlayer "渐变三角形"
```
